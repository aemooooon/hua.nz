const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/three-BY4XbaxT.js","assets/vendor-rLp43SRl.js","assets/leaflet-BD0kuunB.js","assets/leaflet-BTrKGrB8.css","assets/vendor-DSulWsr7.css"])))=>i.map(i=>d[i]);
import{r as M,j as i}from"./react-CgIfOqKe.js";import{P as et}from"./vendor-rLp43SRl.js";import{J as ze,K as ct,X as ht,Y as Ve,C as re,Z as V,e as dt,q as Re,M as U,g as tt,_ as Ie,$ as Ne,a0 as mt,S as gt,b as ft,a1 as ut,W as pt,a2 as xt,r as Le,a3 as yt,a4 as We,a5 as Ce,P as xe,T as Ze,v as ye,w as je,a6 as Qe,k as Je,a7 as ke,a8 as Ee,a9 as Xe,G as wt,L as Ae,j as Ye}from"./three-BY4XbaxT.js";import{u as we,b as bt,_ as St}from"./index-C3Z5zBf4.js";import{C as vt}from"./CircularLoadingIndicator-C-ojp_cu.js";import"./leaflet-BD0kuunB.js";const it=({language:I="zh"})=>{const t=we(y=>y.getAllGalleryItems()),{openPhotoSwipe:e}=bt(),o=M.useRef(null),h=M.useMemo(()=>Array.isArray(t)?t:[],[t]).map((y,$)=>({id:y.id||$,src:y.src,thumbnail:y.thumbnail||y.src,title:y.title||"",description:y.description||""})),u=y=>{e(h,y)};return i.jsxs(i.Fragment,{children:[i.jsx("style",{children:`
        .gallery-mobile-container {
          min-height: 100vh;
          max-height: 100vh;
          overflow-y: auto;
          overflow-x: hidden;
          overscroll-behavior: none;
          
          /* iOS å®‰å…¨åŒºåŸŸæ”¯æŒ */
          padding-top: max(1rem, env(safe-area-inset-top));
          padding-bottom: max(1.5rem, env(safe-area-inset-bottom));
          padding-left: env(safe-area-inset-left);
          padding-right: env(safe-area-inset-right);
          
          /* ç¡®ä¿åœ¨iOSä¸Šå¹³æ»‘æ»šåŠ¨ */
          -webkit-overflow-scrolling: touch;
          
          /* é˜²æ­¢é€‰æ‹©æ–‡æœ¬ */
          -webkit-user-select: none;
          user-select: none;
          
          /* ç¡®ä¿è§¦æ‘¸æ»šåŠ¨æ­£å¸¸å·¥ä½œ */
          touch-action: pan-y;
        }
        
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
        .gallery-mobile-container::-webkit-scrollbar {
          width: 4px;
        }
        .gallery-mobile-container::-webkit-scrollbar-track {
          background: transparent;
        }
        .gallery-mobile-container::-webkit-scrollbar-thumb {
          background: rgba(255, 255, 255, 0.2);
          border-radius: 2px;
        }
        .gallery-mobile-container::-webkit-scrollbar-thumb:hover {
          background: rgba(255, 255, 255, 0.3);
        }
        
        /* ç§»åŠ¨ç«¯ç‰¹æ®Šå¤„ç† */
        @media (max-width: 768px) {
          .gallery-mobile-container {
            /* åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šéšè—æ»šåŠ¨æ¡ */
            scrollbar-width: none;
            -ms-overflow-style: none;
          }
          
          .gallery-mobile-container::-webkit-scrollbar {
            display: none;
          }
          
          /* ç¡®ä¿å›¾ç‰‡ç‚¹å‡»åŒºåŸŸå¯ç”¨ */
          .gallery-image-item {
            touch-action: manipulation;
          }
        }
      `}),i.jsxs("div",{ref:o,className:"gallery-mobile-container w-full",children:[i.jsxs("div",{className:"text-center mb-8 px-4",children:[i.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-theme-text-primary mb-4",children:I==="zh"?"ä½œå“é›†":"Gallery"}),i.jsx("p",{className:"text-theme-text-secondary max-w-2xl mx-auto leading-relaxed",children:I==="zh"?"è®°å½•ç”Ÿæ´»ä¸­çš„ç¾å¥½ç¬é—´ï¼Œæ¯ä¸€å¼ ç…§ç‰‡éƒ½æ‰¿è½½ç€ç‹¬ç‰¹çš„æ•…äº‹ä¸å›å¿†ã€‚":"Capturing beautiful moments in life, each photo carries unique stories and memories."}),i.jsx("p",{className:"text-theme-text-secondary/60 text-sm mt-2",children:I==="zh"?"ç‚¹å‡»å›¾ç‰‡æŸ¥çœ‹å¤§å›¾":"Tap images to view full size"})]}),i.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[i.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3 md:gap-4 pb-8",children:h.map((y,$)=>i.jsx("div",{onClick:()=>u($),className:"group project-card cursor-pointer transform transition-all duration-300 active:scale-95",children:i.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-theme-surface/10",children:[i.jsx("img",{src:y.thumbnail||y.src,alt:`Gallery item ${$+1}`,className:"w-full h-full object-cover",loading:"lazy",onError:te=>{te.target.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjQwIiBmaWxsPSIjMzMzIj48L3JlY3Q+PC9zdmc+"}}),i.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-active:opacity-100 transition-opacity duration-200 flex items-center justify-center",children:i.jsx("div",{className:"w-8 h-8 border-2 border-white rounded-full flex items-center justify-center",children:i.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})})}),i.jsx("div",{className:"absolute top-2 right-2 bg-black/50 backdrop-blur-sm rounded-full w-6 h-6 flex items-center justify-center text-white text-xs font-medium",children:$+1})]})},y.id))}),h.length===0&&i.jsxs("div",{className:"text-center py-16",children:[i.jsx("div",{className:"w-16 h-16 bg-theme-surface/20 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx("svg",{className:"w-8 h-8 text-theme-text-secondary",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),i.jsx("div",{className:"text-theme-text-secondary text-lg mb-2",children:I==="zh"?"æš‚æ— å›¾ç‰‡å†…å®¹":"No gallery items available"}),i.jsx("div",{className:"text-theme-text-secondary/60 text-sm",children:I==="zh"?"è¯·ç¨åå†è¯•":"Please try again later"})]}),h.length>0&&i.jsx("div",{className:"text-center mt-8 py-6",children:i.jsx("p",{className:"text-theme-text-secondary/60 text-sm",children:I==="zh"?`å…± ${h.length} å¼ å›¾ç‰‡ â€¢ ç‚¹å‡»æŸ¥çœ‹å¤§å›¾`:`${h.length} images â€¢ Tap to view full size`})})]})]})]})};it.propTypes={language:et.string};class Mt{constructor(t,e={}){this.scene=t,this.rectLights=[],this.helpers=[],this.animationId=null,this.config={intensity:e.intensity||5,colors:e.colors||[16739179,5164484,4569041,16370212],showHelpers:e.showHelpers||!1,enableAnimation:e.enableAnimation!==!1,animationSpeed:e.animationSpeed||.001,lightWidth:e.lightWidth||6,lightHeight:e.lightHeight||8,positions:e.positions||[{x:-18,y:8,z:15,rx:0,ry:0,rz:0},{x:18,y:8,z:15,rx:0,ry:Math.PI,rz:0},{x:0,y:10,z:35,rx:-Math.PI/2,ry:0,rz:0},{x:0,y:10,z:-15,rx:-Math.PI/2,ry:Math.PI,rz:0}]},this.clock=new ze,this.init()}init(){ct.init(),this.createRectAreaLights(),this.config.enableAnimation&&this.startAnimation()}createRectAreaLights(){this.config.positions.forEach((t,e)=>{const o=this.config.colors[e%this.config.colors.length],d=new ht(o,this.config.intensity,this.config.lightWidth,this.config.lightHeight);if(d.position.set(t.x,t.y,t.z),d.rotation.set(t.rx,t.ry,t.rz),this.scene.add(d),this.rectLights.push(d),this.config.showHelpers){const h=new Ve(d);this.scene.add(h),this.helpers.push(h)}d.userData={originalIntensity:this.config.intensity,originalColor:new re(o),animationPhase:e/this.config.positions.length*Math.PI*2,index:e}})}startAnimation(){const t=()=>{this.animationId=requestAnimationFrame(t),this.updateAnimation()};t()}updateAnimation(){const t=this.clock.getElapsedTime();this.rectLights.forEach((e,o)=>{const d=e.userData,h=Math.sin(t*this.config.animationSpeed*1e3+d.animationPhase);e.intensity=d.originalIntensity+h*2;const u=Math.sin(t*this.config.animationSpeed*500+d.animationPhase*2)*.1;switch(e.color.copy(d.originalColor),o){case 0:e.color.r=Math.max(.3,e.color.r+u);break;case 1:e.color.g=Math.max(.3,e.color.g+u),e.color.b=Math.max(.3,e.color.b+u);break;case 2:e.color.b=Math.max(.3,e.color.b+u);break;case 3:e.color.r=Math.max(.3,e.color.r+u),e.color.g=Math.max(.3,e.color.g+u);break}})}setIntensity(t){this.config.intensity=t,this.rectLights.forEach(e=>{e.userData.originalIntensity=t})}setAnimationSpeed(t){this.config.animationSpeed=t}toggleHelpers(){this.config.showHelpers=!this.config.showHelpers,this.config.showHelpers?this.rectLights.forEach(t=>{const e=new Ve(t);this.scene.add(e),this.helpers.push(e)}):(this.helpers.forEach(t=>{this.scene.remove(t)}),this.helpers=[])}setPreset(t){switch(t){case"warm":this.config.colors=[16739179,16370212,16752627,15620644],this.setIntensity(6),this.setAnimationSpeed(8e-4);break;case"cool":this.config.colors=[5164484,4569041,10837738,2547329],this.setIntensity(5),this.setAnimationSpeed(.0012);break;case"dramatic":this.config.colors=[16726072,3093826,16737096,8121759],this.setIntensity(8),this.setAnimationSpeed(.002);break;case"soft":this.config.colors=[16771751,14524637,10016968,16243823],this.setIntensity(3),this.setAnimationSpeed(5e-4);break}this.rectLights.forEach((e,o)=>{const d=this.config.colors[o%this.config.colors.length];e.userData.originalColor=new re(d)})}toggleAnimation(){this.config.enableAnimation=!this.config.enableAnimation,this.config.enableAnimation?this.startAnimation():(this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.rectLights.forEach(t=>{t.intensity=t.userData.originalIntensity,t.color.copy(t.userData.originalColor)}))}getStatus(){return{intensity:this.config.intensity,animationSpeed:this.config.animationSpeed,enableAnimation:this.config.enableAnimation,showHelpers:this.config.showHelpers,lightCount:this.rectLights.length}}dispose(){this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null),this.rectLights.forEach(t=>{this.scene.remove(t)}),this.rectLights=[],this.helpers.forEach(t=>{this.scene.remove(t)}),this.helpers=[]}}class kt{constructor(t,e={}){this.scene=t,this.lightCubes=[],this.animationId=null,this.config={cubeWidth:e.cubeWidth||1,cubeHeight:e.cubeHeight||8,cubeDepth:e.cubeDepth||1,cubeCount:e.cubeCount||3,positions:[{x:-8,y:2,z:24,height:8},{x:8,y:2,z:24,height:8},{x:0,y:2,z:-18,height:8}],intensity:e.intensity||20,colors:[65416,65535,16711744],enableAnimation:e.enableAnimation!==!1,animationSpeed:e.animationSpeed||.001},this.clock=new ze,this.init()}init(){this.createLightCubes(),this.config.enableAnimation&&this.startAnimation()}createLightCubes(){this.config.positions.forEach((t,e)=>{this.createSingleLightCube(t.x,t.y,t.z,e,t.height)})}createSingleLightCube(t,e,o,d,h){const u={position:{x:t,y:e,z:o},mesh:null,light:null,index:d},y=h||this.config.cubeHeight,$=new V(this.config.cubeWidth,y,this.config.cubeDepth),te=this.config.colors[d%this.config.colors.length],me=new dt({color:te,transparent:!0,opacity:.9,side:Re}),le=new U($,me);le.position.set(t,e,o),this.scene.add(le),u.mesh=le;const ce=new tt(te,this.config.intensity,80);ce.position.set(t,e,o),this.scene.add(ce),u.light=ce,u.originalColor=new re(te),u.originalIntensity=this.config.intensity,u.animationPhase=d*Math.PI*.6,this.lightCubes.push(u);const J=["Lightboxå‰å·¦ä¾§(ç¦»lightboxå¢™6ç±³,ç¦»72ç±³å¢™8ç±³)","Lightboxå‰å³ä¾§(ç¦»lightboxå¢™6ç±³,ç¦»72ç±³å¢™8ç±³)","æ‘„åƒæœºèƒŒåçº¢è‰²æŸ±å­(åŸå§‹é«˜åº¦)"];console.log(`ğŸ¯ åˆ›å»ºå‘å…‰ç«‹æ–¹ä½“ ${d+1}: ${J[d]} ä½ç½®(${t}, ${e}, ${o}), é«˜åº¦${y}ç±³`)}startAnimation(){const t=()=>{this.config.enableAnimation&&(this.updateAnimation(),this.animationId=requestAnimationFrame(t))};t()}updateAnimation(){const t=this.clock.getElapsedTime();this.lightCubes.forEach(e=>{const o=Math.sin(t*this.config.animationSpeed*1e3+e.animationPhase)*.3+.7;e.light.intensity=e.originalIntensity*o;const d=Math.sin(t*this.config.animationSpeed*500+e.animationPhase)*.1,h={};e.originalColor.getHSL(h),h.h=(h.h+d)%1;const u=new re().setHSL(h.h,h.s,h.l);e.light.color.copy(u),e.mesh.material.color.copy(u)})}stopAnimation(){this.config.enableAnimation=!1,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}setIntensity(t){this.config.intensity=t,this.lightCubes.forEach(e=>{e.originalIntensity=t})}toggleAnimation(){this.config.enableAnimation=!this.config.enableAnimation,this.config.enableAnimation?this.startAnimation():this.stopAnimation()}getStatus(){return{cubeCount:this.config.cubeCount,intensity:this.config.intensity,enableAnimation:this.config.enableAnimation}}dispose(){this.stopAnimation(),this.lightCubes.forEach(t=>{t.mesh&&(this.scene.remove(t.mesh),t.mesh.geometry.dispose(),t.mesh.material.dispose()),t.light&&this.scene.remove(t.light)}),this.lightCubes=[]}}class At{constructor(t,e,o={}){this.scene=t,this.renderer=e,this.spotlights=[],this.animationId=null,this.config={lightCount:o.lightCount||4,ceilingHeight:o.ceilingHeight||10,positions:[{x:-36,y:10,z:0},{x:36,y:10,z:0},{x:0,y:10,z:-24}],targets:[{x:-32,y:1,z:0},{x:32,y:1,z:0},{x:0,y:1,z:-20}],intensity:o.intensity||3500,distance:o.distance||70,angle:o.angle||Math.PI/2,penumbra:o.penumbra||.3,colors:[16711744,65416,65535],enableAnimation:o.enableAnimation!==!1,animationSpeed:o.animationSpeed||.5,showHelpers:o.showHelpers||!1},this.clock=new ze,this.init()}async init(){try{await this.createSpotlights(),this.config.enableAnimation&&this.startAnimation(),console.log("âœ¨ IESèšå…‰ç¯ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ")}catch(t){console.warn("âš ï¸ IESèšå…‰ç¯åˆå§‹åŒ–å¤±è´¥ï¼Œä½¿ç”¨æ ‡å‡†èšå…‰ç¯:",t),this.createStandardSpotlights()}}async createSpotlights(){let t=null;try{t=(await St(()=>import("./three-BY4XbaxT.js").then(o=>o.aa),__vite__mapDeps([0,1,2,3,4]))).IESSpotLight}catch(e){console.log("ğŸ¯ IESSpotLightä¸å¯ç”¨:",e.message)}t&&this.renderer.isWebGPURenderer?(console.log("ğŸ¯ ä½¿ç”¨IESèšå…‰ç¯ (WebGPU)"),await this.createIESSpotlights(t)):(console.log("ğŸ¯ ä½¿ç”¨æ ‡å‡†èšå…‰ç¯ï¼ˆé™çº§æ–¹æ¡ˆï¼‰"),this.createStandardSpotlights())}async createIESSpotlights(t){for(let e=0;e<this.config.lightCount;e++){const o=this.config.positions[e],d=this.config.targets[e],h=this.config.colors[e%this.config.colors.length],u=new t(h,this.config.intensity);if(u.position.set(o.x,o.y,o.z),u.angle=this.config.angle,u.penumbra=this.config.penumbra,u.distance=this.config.distance,u.castShadow=!0,u.shadow.mapSize.width=2048,u.shadow.mapSize.height=2048,u.shadow.camera.near=.5,u.shadow.camera.far=this.config.distance,u.shadow.bias=-1e-4,u.shadow.normalBias=.02,u.target.position.set(d.x,d.y,d.z),this.scene.add(u),this.scene.add(u.target),this.config.showHelpers){const $=new Ie(u);u.userData.helper=$,this.scene.add($)}const y={light:u,originalPosition:{...o},originalTarget:{...d},originalIntensity:this.config.intensity,originalColor:new re(h),animationPhase:e*Math.PI*.5,index:e};this.spotlights.push(y),console.log(`ğŸ’¡ åˆ›å»ºIESèšå…‰ç¯ ${e+1}: ä½ç½®(${o.x}, ${o.y}, ${o.z}) -> ç›®æ ‡(${d.x}, ${d.y}, ${d.z})`)}}createStandardSpotlights(){for(let t=0;t<this.config.lightCount;t++){const e=this.config.positions[t],o=this.config.targets[t],d=this.config.colors[t%this.config.colors.length],h=new Ne(d,this.config.intensity,this.config.distance,this.config.angle,this.config.penumbra);if(h.position.set(e.x,e.y,e.z),h.castShadow=!0,h.shadow.mapSize.width=2048,h.shadow.mapSize.height=2048,h.shadow.camera.near=.5,h.shadow.camera.far=this.config.distance,h.shadow.bias=-1e-4,h.shadow.normalBias=.02,h.target.position.set(o.x,o.y,o.z),this.scene.add(h),this.scene.add(h.target),this.config.showHelpers){const y=new Ie(h);h.userData.helper=y,this.scene.add(y)}const u={light:h,originalPosition:{...e},originalTarget:{...o},originalIntensity:this.config.intensity,originalColor:new re(d),animationPhase:t*Math.PI*.5,index:t};this.spotlights.push(u),console.log(`ğŸ’¡ åˆ›å»ºæ ‡å‡†èšå…‰ç¯ ${t+1}: ä½ç½®(${e.x}, ${e.y}, ${e.z}) -> ç›®æ ‡(${o.x}, ${o.y}, ${o.z})`)}}startAnimation(){const t=()=>{this.config.enableAnimation&&(this.updateAnimation(),this.animationId=requestAnimationFrame(t))};t()}updateAnimation(){const t=this.clock.getElapsedTime()*this.config.animationSpeed;this.spotlights.forEach((e,o)=>{const{light:d,originalTarget:h,animationPhase:u}=e,y=t+u,$=2,te=h.x+Math.sin(y*.8)*$*.3,me=h.z+Math.cos(y*.6)*$*.3,le=h.y+Math.sin(y*.4)*.5;d.target.position.x=te,d.target.position.y=le,d.target.position.z=me;const ce=.9,J=Math.sin(y*1.2+o*.5)*.2;d.intensity=e.originalIntensity*(ce+J);const ge=Math.sin(y*.8+o*.6)*.3,Y={};e.originalColor.getHSL(Y);const ae=(Y.h+ge+t*.1)%1,_=Math.max(.7,Y.s+Math.sin(y*1.5)*.3),fe=Math.max(.4,Math.min(.8,Y.l+Math.sin(y*2)*.2)),ie=new re().setHSL(ae,_,fe);d.color.copy(ie);const ee=Math.sin(y*.5+o*.3)*.02;d.angle=this.config.angle+ee,d.userData.helper&&d.userData.helper.update()})}setIntensity(t){this.config.intensity=t,this.spotlights.forEach(e=>{e.originalIntensity=t,e.light.intensity=t})}setAnimationSpeed(t){this.config.animationSpeed=t}toggleHelpers(){this.config.showHelpers=!this.config.showHelpers,this.spotlights.forEach(t=>{const{light:e}=t;if(this.config.showHelpers){if(!e.userData.helper){const o=new Ie(e);e.userData.helper=o,this.scene.add(o)}e.userData.helper.visible=!0}else e.userData.helper&&(e.userData.helper.visible=!1)})}toggleAnimation(){this.config.enableAnimation=!this.config.enableAnimation,this.config.enableAnimation?this.startAnimation():this.stopAnimation()}stopAnimation(){this.config.enableAnimation=!1,this.animationId&&(cancelAnimationFrame(this.animationId),this.animationId=null)}getStatus(){return{lightCount:this.config.lightCount,intensity:this.config.intensity,enableAnimation:this.config.enableAnimation,showHelpers:this.config.showHelpers,animationSpeed:this.config.animationSpeed}}dispose(){this.stopAnimation(),this.spotlights.forEach(t=>{const{light:e}=t;e&&(this.scene.remove(e),this.scene.remove(e.target),e.userData.helper&&this.scene.remove(e.userData.helper))}),this.spotlights=[],console.log("ğŸ§¹ IESèšå…‰ç¯ç³»ç»Ÿå·²æ¸…ç†")}}const zt=({language:I="en"})=>{var Ge,$e,Be,Oe,_e,qe,Ue;const[t,e]=M.useState(!0),[o,d]=M.useState(!1),[h,u]=M.useState(!1),[y,$]=M.useState(!1),[te,me]=M.useState(!1),[le,ce]=M.useState(!1),J=we(k=>k.getAllGalleryItems()),ge=we(k=>k.texts),Y=we(k=>k.isPointerLocked),ae=we(k=>k.setIsPointerLocked),_=M.useRef({w:!1,a:!1,s:!1,d:!1,ArrowUp:!1,ArrowDown:!1,ArrowLeft:!1,ArrowRight:!1});M.useEffect(()=>{const k=()=>{const ne=window.innerWidth<=768||"ontouchstart"in window;$(ne),ne&&me(!0)};return k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[]);const fe=M.useRef(null),ie=M.useRef(null),ee=M.useRef(null),he=M.useRef(null),K=M.useRef(null),be=M.useRef(null),nt=M.useRef(new ze),He=M.useRef(null),De=M.useRef([]),Te=M.useRef(null),Fe=M.useRef([]),ue=M.useRef(null),Se=M.useRef(null),ve=M.useRef(null),st=M.useRef(null),at=M.useRef(null);return M.useEffect(()=>{if(!fe.current)return;const k=fe.current,ne=l=>{const s=new Qe;l.add(s),He.current=s;const g=32,b=72,L=new xe(g,b),S=(()=>{const c=document.createElement("canvas"),r=1024;c.width=r,c.height=r;const n=c.getContext("2d"),R="#1a1a1a",H=["#262626","#2a2a2a","#1e1e1e","#333333","#2d2d2d"];n.fillStyle=R,n.fillRect(0,0,r,r);for(let Q=0;Q<2e3;Q++){const W=Math.random()*r,P=Math.random()*r,F=Math.random()*8+2,G=Math.random()*.3+.1;n.globalAlpha=G,n.fillStyle=H[Math.floor(Math.random()*H.length)],n.beginPath(),n.arc(W,P,F,0,Math.PI*2),n.fill()}n.globalAlpha=.15,n.strokeStyle="#404040",n.lineWidth=1;for(let Q=0;Q<50;Q++){const W=Math.random()*r,P=Math.random()*r,F=Math.random()*100+50,G=Math.random()*Math.PI*2;n.beginPath(),n.moveTo(W,P),n.lineTo(W+Math.cos(G)*F,P+Math.sin(G)*F),n.stroke()}const N=n.createRadialGradient(r/2,r/2,0,r/2,r/2,r/2);N.addColorStop(0,"rgba(80, 80, 80, 0.15)"),N.addColorStop(.5,"rgba(60, 60, 60, 0.08)"),N.addColorStop(1,"rgba(40, 40, 40, 0.02)"),n.globalAlpha=1,n.fillStyle=N,n.fillRect(0,0,r,r),n.globalAlpha=.06;for(let Q=0;Q<15;Q++){const W=Math.random()*r,P=Math.random()*r,F=Math.random()*2+1;n.fillStyle="#00ffaa",n.beginPath(),n.arc(W,P,F,0,Math.PI*2),n.fill()}n.globalAlpha=1;const j=new Je(c);return j.wrapS=ke,j.wrapT=ke,j.repeat.set(6,6),j})(),C=new Ce({map:S,color:1710618,metalness:.05,roughness:.3,envMapIntensity:1.2}),B=new U(L,C);B.rotation.x=-Math.PI/2,B.position.y=-2,B.receiveShadow=!0,l.add(B);const se=(()=>{const c=document.createElement("canvas"),r=1024;c.width=r,c.height=r;const n=c.getContext("2d");n.fillStyle="#f8f8f8",n.fillRect(0,0,r,r);const R=64,H=2;n.strokeStyle="#e0e0e0",n.lineWidth=H;for(let j=0;j<=r;j+=R)n.beginPath(),n.moveTo(j,0),n.lineTo(j,r),n.stroke();for(let j=0;j<=r;j+=R)n.beginPath(),n.moveTo(0,j),n.lineTo(r,j),n.stroke();const N=new Je(c);return N.wrapS=ke,N.wrapT=ke,N.repeat.set(4,4),N})(),oe=new U(new xe(g,b),new ye({map:se,color:16777215,transparent:!1,side:Re}));oe.rotation.x=Math.PI/2,oe.position.y=8,oe.receiveShadow=!0,l.add(oe);const T=new ye({color:16316664,side:je,transparent:!1}),O=32,w=72,p=12,a=.5,f=new U(new V(O,p,a),T);f.position.set(0,3,-36),f.receiveShadow=!0,f.castShadow=!1,s.add(f),l.add(f);const x=new U(new V(10,p,a),T);x.position.set(-11,3,36),x.receiveShadow=!0,x.castShadow=!1,s.add(x),l.add(x);const A=new U(new V(10,p,a),T);A.position.set(11,3,36),A.receiveShadow=!0,A.castShadow=!1,s.add(A),l.add(A);const z=new U(new V(a,p,w),T);z.position.set(-16,3,0),z.receiveShadow=!0,z.castShadow=!1,s.add(z),l.add(z);const m=new U(new V(a,p,w),T);m.position.set(16,3,0),m.receiveShadow=!0,m.castShadow=!1,s.add(m),l.add(m)},q=(l,s=null)=>{if(!J||J.length===0){for(let p=0;p<6;p++){const a=new xe(3,2),f=new ye({color:6710886}),x=new U(a,f);p<3?(x.position.set(-6+p*6,3,-14.9),x.rotation.y=0):(x.position.set(-14.9,3,-6+(p-3)*6),x.rotation.y=Math.PI/2),l.add(x)}return}const g=Math.min(J.length,22),b=2.2,L=4,v=async()=>{const p=[];for(let a=0;a<Math.min(J.length,g);a++){const f=J[a];if(f.src||f.thumbnail)try{const x=await B(f.src||f.thumbnail),A=x.width/x.height;p.push({index:a,item:f,aspectRatio:A,isPortrait:A<.8,isLandscape:A>1.3,isSquare:A>=.8&&A<=1.3})}catch{p.push({index:a,item:f,aspectRatio:1,isPortrait:!1,isLandscape:!1,isSquare:!0})}}return p},S=p=>{const a={backWall:[],rightWall:[],leftWall:[],frontWall:[]},f=p.filter(c=>c.item.position!=="lightbox"),x=f.filter(c=>c.item.wall==="vertical_wall_32m"),A=f.filter(c=>c.item.wall==="horizontal_wall_64m"),z=A.filter(c=>c.item.layer==="upper"),m=A.filter(c=>c.item.layer==="lower");return a.backWall=x.slice(0,3),a.frontWall=x.slice(3,5),a.rightWall=[...z.slice(0,4),...m.slice(0,4)],a.leftWall=[...z.slice(4,8),...m.slice(4,8)],a},C=async()=>{const p=await v(),a=S(p),f=new Ze(s||void 0),x=new Map,A=async(m,c,r)=>{const n=m.item,R=m.aspectRatio;let H,N;R>1.5?(H=Math.min(L,b*R*.8),N=H/R):R<.7?(N=b,H=N*R):(N=b*.9,H=N*R);const j=new xe(H,N),Q=new Xe({color:16777215,metalness:0,roughness:.15,clearcoat:.1,clearcoatRoughness:.1,reflectivity:.3,emissive:1052688,emissiveIntensity:.02,side:Re}),W=new U(j,Q),P=w(W,H,N),F=35.5;switch(c){case"backWall":P.position.set(-10+r*10,2.4,-35.5),P.rotation.y=0;break;case"rightWall":{const{x:E,y:D,z:X}=Z(m.item,a.rightWall);P.position.set(E,D,X),P.rotation.y=-Math.PI/2;break}case"leftWall":{const{x:E,y:D,z:X}=se(m.item,a.leftWall);P.position.set(E,D,X),P.rotation.y=Math.PI/2;break}case"frontWall":r===0?P.position.set(-10,2.4,F):P.position.set(10,2.4,F),P.rotation.y=Math.PI;break}P.castShadow=!1,P.receiveShadow=!1,l.add(P),Fe.current.push({mesh:P,position:P.position.clone(),painting:W}),setTimeout(()=>{(c==="frontWall"||c==="rightWall"&&m.item.layer==="lower"||c==="leftWall"&&m.item.layer==="lower")&&oe(P)},100);const G=n.src||n.thumbnail;if(x.has(G))W.material.map=x.get(G),W.material.color.setHex(16777215),W.material.needsUpdate=!0;else try{if(n.type==="video"){const E=document.createElement("video");E.src=G,E.autoplay=n.autoplay||!0,E.loop=n.loop||!0,E.muted=n.muted||!0,E.controls=n.controls||!1,E.crossOrigin="anonymous",E.playsInline=!0,await new Promise((X,pe)=>{E.oncanplay=X,E.onerror=pe,E.load()});const D=new wt(E);D.generateMipmaps=!1,D.minFilter=Ae,D.magFilter=Ae,D.colorSpace=Le,x.set(G,D),W.material.map=D,W.material.color.setHex(16777215),W.material.needsUpdate=!0,E.play().catch(X=>{console.warn("è§†é¢‘è‡ªåŠ¨æ’­æ”¾å¤±è´¥ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’:",X)}),console.log(`ğŸ¬ åŠ è½½è§†é¢‘çº¹ç†: ${n.title.zh||n.title.en}`)}else{await(X=>new Promise((pe,lt)=>{const Pe=new Image;Pe.onload=()=>pe(!0),Pe.onerror=()=>lt(!1),Pe.src=X}))(G);const D=await new Promise((X,pe)=>{f.load(G,X,void 0,pe)});D.generateMipmaps=!1,D.minFilter=Ae,D.magFilter=Ae,D.colorSpace=Le,x.set(G,D),W.material.map=D,W.material.color.setHex(16777215),W.material.needsUpdate=!0}}catch{W.material.color.setHex(6710886),W.material.needsUpdate=!0}},z=[...a.backWall.map((m,c)=>({data:m,wallType:"backWall",index:c})),...a.rightWall.map((m,c)=>({data:m,wallType:"rightWall",index:c})),...a.leftWall.map((m,c)=>({data:m,wallType:"leftWall",index:c})),...a.frontWall.map((m,c)=>({data:m,wallType:"frontWall",index:c}))];for(let m=0;m<z.length;m+=4){const c=z.slice(m,m+4);await Promise.all(c.map(({data:r,wallType:n,index:R})=>A(r,n,R))),m+4<z.length&&await new Promise(r=>setTimeout(r,100))}},B=p=>new Promise(a=>{const f=new Image;f.onload=()=>{a({width:f.width,height:f.height})},f.onerror=()=>{a({width:300,height:200})},f.src=p}),Z=(p,a)=>{const m=[-28,-12,4,20],c=[-20,-4,12,28];if(p.layer==="upper"){const r=a.filter(n=>n.item.layer==="upper").findIndex(n=>n.item.id===p.id);return{x:15.5,y:1.6+1.6,z:c[r]||0}}else{const r=a.filter(n=>n.item.layer==="lower").findIndex(n=>n.item.id===p.id);return{x:15.5,y:1.6,z:m[r]||0}}},se=(p,a)=>{const x=Z(p,a);return{x:-15.5,y:x.y,z:-x.z}},oe=p=>{const a=p.position,f=p.rotation,x=Math.abs(f.y)<.1||Math.abs(f.y-Math.PI)<.1;let A,z,m,c;x?(A=Math.PI/9,z=.08,m=12,c=6):(A=Math.PI/6,z=.15,m=15,c=3.5);const r=new Ne(16775393,1.5,m,A,z,1);let n=new Ye;const R=Math.max(7,a.y+c),H=1.8;return Math.abs(f.y)<.1?n.set(a.x,R,a.z+H):Math.abs(f.y-Math.PI)<.1?n.set(a.x,R,a.z-H):Math.abs(f.y+Math.PI/2)<.1?n.set(a.x-H,R,a.z):Math.abs(f.y-Math.PI/2)<.1&&n.set(a.x+H,R,a.z),r.position.copy(n),r.target=p,r.castShadow=!1,r.userData={paintingPosition:a.clone(),baseIntensity:1,maxIntensity:8,activationDistance:6,optimalDistance:2},l.add(r),l.add(r.target),De.current.push(r),r},T=.05,O=.1,w=(p,a=2.5,f=2)=>{const x=new Qe,A=new Xe({color:1710618,metalness:.8,roughness:.2,clearcoat:.3,clearcoatRoughness:.1,emissive:657930,emissiveIntensity:.05}),z=[new V(a+O*2,O,T),new V(a+O*2,O,T),new V(O,f,T),new V(O,f,T)],m=[{x:0,y:(f+O)/2,z:T/2},{x:0,y:-(f+O)/2,z:T/2},{x:-(a+O)/2,y:0,z:T/2},{x:(a+O)/2,y:0,z:T/2}];return z.forEach((c,r)=>{const n=new U(c,A);n.position.set(m[r].x,m[r].y,m[r].z),n.castShadow=!1,n.receiveShadow=!1,x.add(n)}),x.add(p),x};C()},de=(l,s)=>{const g=6*l,b=he.current,L=b.position.clone();(_.current.w||_.current.ArrowUp)&&s.moveForward(g),(_.current.s||_.current.ArrowDown)&&s.moveForward(-g),(_.current.d||_.current.ArrowRight)&&s.moveRight(g),(_.current.a||_.current.ArrowLeft)&&s.moveRight(-g),Me(b)&&b.position.copy(L),b.position.y=2.4,ot(b.position)},Me=l=>{const s=l.position,g=14.5,b=34.5;return s.x>g||s.x<-g||s.z>b||s.z<-b},ot=l=>{De.current.forEach(s=>{const g=s.userData;if(!g||!g.paintingPosition)return;const b=l.distanceTo(g.paintingPosition);let L=g.baseIntensity;if(b<=g.activationDistance){const v=Math.max(0,(g.activationDistance-b)/g.activationDistance),S=g.maxIntensity-g.baseIntensity,C=Math.pow(v,1.5);L=g.baseIntensity+S*C,b<=g.optimalDistance&&(L=g.maxIntensity)}s.intensity=Ee.lerp(s.intensity,L,.12)}),rt(l)},rt=l=>{const s=Te.current;if(!s)return;let g=1/0;Fe.current.forEach(L=>{const v=l.distanceTo(L.position);v<g&&(g=v)});const b=he.current;if(b){const L=new Ye;b.getWorldDirection(L);const v=b.position.clone().add(L.multiplyScalar(10));s.target.position.copy(v),s.target.updateMatrixWorld()}if(g<=6){const v=3+Math.max(0,(6-g)/6)*12;s.intensity=Ee.lerp(s.intensity,v,.1)}else s.intensity=Ee.lerp(s.intensity,1.5,.1)},Ke=()=>{const l=he.current;if(!l)return;const s={phase1:{duration:2500,startPos:{x:0,y:2.4,z:15},endPos:{x:0,y:2.4,z:12},startLookAt:{x:0,y:8,z:0},endLookAt:{x:0,y:8,z:0}},phase2:{duration:3e3,startPos:{x:0,y:2.4,z:12},endPos:{x:0,y:2.4,z:5},startLookAt:{x:0,y:8,z:0},endLookAt:{x:0,y:4,z:0}},phase3:{duration:2e3,startPos:{x:0,y:2.4,z:5},endPos:{x:0,y:2.4,z:0},startLookAt:{x:0,y:4,z:0},endLookAt:{x:0,y:2.4,z:-1}}};l.position.set(s.phase1.startPos.x,s.phase1.startPos.y,s.phase1.startPos.z),l.lookAt(s.phase1.startLookAt.x,s.phase1.startLookAt.y,s.phase1.startLookAt.z);let g=1,b=Date.now();const L=S=>{const C=Date.now()-b,B=Math.min(C/S.duration,1),Z=B<.5?4*B*B*B:1-Math.pow(-2*B+2,3)/2;l.position.x=S.startPos.x+(S.endPos.x-S.startPos.x)*Z,l.position.y=S.startPos.y+(S.endPos.y-S.startPos.y)*Z,l.position.z=S.startPos.z+(S.endPos.z-S.startPos.z)*Z;const se={x:S.startLookAt.x+(S.endLookAt.x-S.startLookAt.x)*Z,y:S.startLookAt.y+(S.endLookAt.y-S.startLookAt.y)*Z,z:S.startLookAt.z+(S.endLookAt.z-S.startLookAt.z)*Z};return l.lookAt(se.x,se.y,se.z),B>=1},v=()=>{let S=!1;switch(g){case 1:S=L(s.phase1),S&&(g=2,b=Date.now());break;case 2:S=L(s.phase2),S&&(g=3,b=Date.now());break;case 3:if(S=L(s.phase3),S){d(!0),e(!1),setTimeout(()=>{u(!0)},9e3),K.current&&(K.current.getObject().position.copy(l.position),K.current.connect=K.current.connect.__original||K.current.connect);return}break}st.current=requestAnimationFrame(v)};v()};return(()=>{try{const l=new mt;at.current=l,l.onLoad=()=>{requestAnimationFrame(()=>{ee.current&&ie.current&&he.current?(ee.current.render(ie.current,he.current),requestAnimationFrame(()=>{setTimeout(()=>{Ke()},300)})):setTimeout(()=>{Ke()},500)})},l.onError=()=>{};const s=new gt;s.background=new re(1710618),ie.current=s;const g=new ft(75,k.clientWidth/k.clientHeight,.1,1e3);g.position.set(0,2.4,0),he.current=g;const b=new Ne(16774374,6,15,Math.PI/5,.15,1.2);b.position.set(0,0,0),b.castShadow=!1;const L=new ut;b.target=L,g.add(b),s.add(L),s.add(g),Te.current=b;const v=new pt({antialias:!0,alpha:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1});if(v.setSize(k.clientWidth,k.clientHeight),v.setClearColor(15790320,1),v.shadowMap.enabled=!0,v.shadowMap.type=xt,v.outputColorSpace=Le,v.toneMapping=yt,v.toneMappingExposure=1,!v.getContext())throw new Error("WebGL context creation failed");k.appendChild(v.domElement),ee.current=v;let C;try{document&&document.body&&document.documentElement&&window.self===window.top&&"requestPointerLock"in document.body?C=new We(g,document.body):(C=new We(g,v.domElement),console.warn("Pointer Lock API not available, using fallback mode"))}catch(w){console.warn("PointerLockControls initialization failed:",w),C=new We(g,v.domElement)}s.add(C.getObject()),K.current=C;try{C.addEventListener("lock",()=>{ae(!0)}),C.addEventListener("unlock",()=>{ae(!1)})}catch(w){console.warn("PointerLockControls event setup failed:",w)}try{const w=C.connect;w&&(C.connect.__original=w,C.connect=()=>{if(o)try{w.call(C)}catch(p){console.warn("PointerLockControls connect failed:",p)}})}catch(w){console.warn("PointerLockControls connect override failed:",w)}const B=w=>{const a=(()=>{const z=new V(12,12,.4),m=new Ce({color:16777215,emissive:0,emissiveIntensity:0}),c=new U(z,m);c.position.set(0,3,35.8),w.add(c);const n=(()=>{const N=new xe(11,9),j=J.find(G=>G.position==="lightbox"),Q=j?j.src||j.thumbnail:"/gallery/gallery-vertical-0.jpg",W=new Ze,P=new ye({color:4474111,emissive:0,emissiveIntensity:0,transparent:!0,opacity:.61,side:je}),F=new U(N,P);return F.position.set(0,3,36-.4-.02),F.rotation.y=Math.PI,F.name="LightboxGallery",w.add(F),W.load(Q,G=>{const E=new ye({map:G,emissive:0,emissiveIntensity:0,transparent:!0,opacity:.61,side:je});F.material=E},()=>{},()=>{}),F})();return{lightBox:c,lightboxDisplay:n}})();return{wallLightBox:a.lightBox,lightboxDisplay:a.lightboxDisplay}},Z=()=>{const w=[];return[{start:{x:-3,z:2.25},end:{x:3,z:2.25},name:"ç‹-ä¸Šæ¨ª"},{start:{x:-2.5,z:0},end:{x:2.5,z:0},name:"ç‹-ä¸­æ¨ª"},{start:{x:-3.5,z:-2.25},end:{x:3.5,z:-2.25},name:"ç‹-ä¸‹æ¨ª"},{start:{x:0,z:2.25},end:{x:0,z:-2.25},name:"ç‹-ç«–çº¿"}].forEach(a=>{const f=Math.sqrt(Math.pow(a.end.x-a.start.x,2)+Math.pow(a.end.z-a.start.z,2));let x;a.name.includes("ç«–")?x=new V(.4,.2,f):x=new V(f,.2,.4);const A=new Ce({color:16777215,emissive:16777215,emissiveIntensity:2,transparent:!1}),z=new U(x,A),m=(a.start.x+a.end.x)/2,c=(a.start.z+a.end.z)/2;z.position.set(m,6,c),s.add(z);const r=new tt(16777215,7,45);r.position.set(m,5.5,c),s.add(r),w.push({tube:z,name:a.name})}),w};B(s),Z(),ne(s),q(s,l);const se=()=>{try{const w={intensity:4,colors:[16739179,5164484,4569041,16370212],showHelpers:!1,enableAnimation:!0,animationSpeed:8e-4,lightWidth:8,lightHeight:6,positions:[{x:-30,y:10,z:0,rx:0,ry:Math.PI/2,rz:0},{x:30,y:10,z:0,rx:0,ry:-Math.PI/2,rz:0},{x:0,y:11.5,z:30,rx:-Math.PI/3,ry:0,rz:0},{x:0,y:11.5,z:-10,rx:-Math.PI/3,ry:Math.PI,rz:0}]};ue.current=new Mt(s,w),ue.current.setPreset("soft"),console.log("RectAreaLightingç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸ")}catch(w){console.warn("RectAreaLightingåˆå§‹åŒ–å¤±è´¥:",w)}},oe=()=>{try{const w={cubeSize:2.5,cubeCount:3,spacing:10,height:6,intensity:2.5,lightSize:2,enableAnimation:!0,animationSpeed:.001,showCubeMesh:!0,cubeOpacity:.05,showHelpers:!1};Se.current=new kt(s,w),console.log("å…‰ç«‹æ–¹ä½“ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸ")}catch(w){console.warn("å…‰ç«‹æ–¹ä½“ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:",w)}},T=()=>{try{const w={lightCount:3,intensity:4200,distance:80,angle:Math.PI/1.8,penumbra:.4,enableAnimation:!0,animationSpeed:.3,showHelpers:!1};ve.current=new At(s,v,w),console.log("âœ¨ 3ç¯ä½IESèšå…‰ç¯ç³»ç»Ÿåˆå§‹åŒ–æˆåŠŸ - é¿å¼€lightboxå¢™é¢")}catch(w){console.warn("âš ï¸ IESèšå…‰ç¯ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥:",w)}};setTimeout(()=>{se(),setTimeout(()=>{oe(),setTimeout(()=>{T()},200)},100)},300);const O=()=>{be.current=requestAnimationFrame(O);const w=nt.current.getDelta();C.isLocked&&de(w,C),s.traverse(p=>{p.material&&p.material.map&&p.material.map.isVideoTexture&&(p.material.map.needsUpdate=!0)}),v.render(s,g)};O(),e(!1)}catch(l){throw e(!1),l}})(),()=>{ue.current&&(ue.current.dispose(),ue.current=null),Se.current&&(Se.current.dispose(),Se.current=null),ve.current&&(ve.current.dispose(),ve.current=null),be.current&&(cancelAnimationFrame(be.current),be.current=null),K.current&&(K.current.dispose(),K.current=null),ie.current&&(ie.current.traverse(l=>{l.geometry&&l.geometry.dispose(),l.material&&(Array.isArray(l.material)?l.material.forEach(s=>{s.map&&s.map.dispose(),s.normalMap&&s.normalMap.dispose(),s.roughnessMap&&s.roughnessMap.dispose(),s.dispose()}):(l.material.map&&l.material.map.dispose(),l.material.normalMap&&l.material.normalMap.dispose(),l.material.roughnessMap&&l.material.roughnessMap.dispose(),l.material.dispose()))}),ie.current.clear(),ie.current=null),ee.current&&(k&&k.contains(ee.current.domElement)&&k.removeChild(ee.current.domElement),ee.current.dispose(),ee.current=null),he.current=null,He.current=null}},[J,o,ae]),M.useEffect(()=>{const k=q=>{var Me;const de=q.code==="KeyW"?"w":q.code==="KeyA"?"a":q.code==="KeyS"?"s":q.code==="KeyD"?"d":q.key.toLowerCase();de in _.current&&(_.current[de]=!0),q.key==="Escape"&&((Me=K.current)!=null&&Me.isLocked)&&K.current.unlock()},ne=q=>{const de=q.code==="KeyW"?"w":q.code==="KeyA"?"a":q.code==="KeyS"?"s":q.code==="KeyD"?"d":q.key;de in _.current&&(_.current[de]=!1)};return document.addEventListener("keydown",k),document.addEventListener("keyup",ne),()=>{document.removeEventListener("keydown",k),document.removeEventListener("keyup",ne)}},[]),i.jsxs(i.Fragment,{children:[y&&te&&i.jsx("div",{className:"fixed inset-0 z-[99999] bg-black/90 backdrop-blur-sm flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-8 text-center max-w-md border border-white/20",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("svg",{className:"w-16 h-16 text-yellow-400 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"})}),i.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:I==="zh"?"ç§»åŠ¨ç«¯ä½“éªŒæç¤º":"Mobile Experience Notice"}),i.jsx("p",{className:"text-white/80 leading-relaxed",children:I==="zh"?"3D ç”»å»Šé‡‡ç”¨ç¬¬ä¸€äººç§°æ¼«æ¸¸æŠ€æœ¯ï¼Œéœ€è¦é”®ç›˜å’Œé¼ æ ‡æ“ä½œï¼Œç§»åŠ¨ç«¯ä½“éªŒå¯èƒ½ä¸ä½³ã€‚å»ºè®®ä½¿ç”¨æ¡Œé¢è®¾å¤‡ä»¥è·å¾—æœ€ä½³æµè§ˆæ•ˆæœã€‚":"The 3D gallery uses first-person navigation technology requiring keyboard and mouse controls. For the best experience, Hua recommend using a desktop device."})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:()=>{me(!1),ce(!0)},className:"w-full bg-theme-primary/20 hover:bg-theme-primary/30 text-theme-primary border border-theme-primary/30 hover:border-theme-primary/50 py-3 px-6 rounded-lg transition-all duration-300",children:I==="zh"?"ç»§ç»­æµè§ˆå›¾ç‰‡é›†":"View Image Gallery"}),i.jsx("p",{className:"text-white/60 text-sm",children:I==="zh"?"æˆ–åœ¨æ¡Œé¢è®¾å¤‡ä¸Šä½“éªŒå®Œæ•´çš„ 3D ç”»å»Š":"Or visit on desktop for the full 3D gallery experience"})]})]})}),y&&le&&i.jsx(it,{language:I,texts:ge}),!y&&i.jsxs("section",{id:"gallery",className:"min-h-screen flex flex-col justify-center items-center bg-gray-100 relative overflow-hidden",children:[(t||!o)&&i.jsx(vt,{size:160,strokeWidth:12,showMask:!0,maskColor:"black-solid"}),i.jsx("div",{ref:fe,className:`w-full h-screen relative bg-gray-200 ${t||!o?"invisible":"visible"}`,style:{minHeight:"100vh"}}),i.jsxs("div",{className:`absolute bottom-6 left-6 bg-black/50 backdrop-blur-md rounded-xl p-4 text-white z-20 max-w-sm transition-all duration-1000 ${!t&&o&&h&&!Y?"opacity-100 translate-y-0":"opacity-0 translate-y-4 pointer-events-none"}`,children:[i.jsx("p",{className:"text-lg font-medium mb-3",children:I==="zh"?"å¦‚ä½•æ“ä½œï¼Ÿ":"How to Play?"}),i.jsxs("div",{className:"space-y-3 text-sm",children:[i.jsxs("p",{className:"flex items-center",children:[i.jsx("span",{className:"w-2"}),I==="zh"?"ç‚¹å‡»è¿›å…¥é•¿å»Š":"Click to enter the gallery"]}),i.jsxs("p",{className:"flex items-center",children:[i.jsx("span",{className:"w-2"}),I==="zh"?"é¼ æ ‡ - ç¯è§†å‘¨å›´ï¼Œæ¢ç´¢ç”»ä½œ":"Mouse - Look around and explore"]}),i.jsxs("p",{className:"flex items-center",children:[i.jsx("span",{className:"w-2"}),i.jsxs("span",{className:"inline-flex items-center gap-1 mr-2",children:[i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-white/20 rounded text-xs font-mono border border-white/30",children:"W"}),i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-white/20 rounded text-xs font-mono border border-white/30",children:"A"}),i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-white/20 rounded text-xs font-mono border border-white/30",children:"S"}),i.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-white/20 rounded text-xs font-mono border border-white/30",children:"D"})]}),i.jsx("span",{children:I==="zh"?"ç§»åŠ¨ç©¿è¡Œé•¿å»Š":"Move through the gallery"})]}),i.jsxs("p",{className:"flex items-center",children:[i.jsx("span",{className:"w-2"}),i.jsx("span",{className:"inline-flex items-center px-2 py-0.5 mr-2 bg-white/20 rounded text-xs font-mono border border-white/30",children:"ESC"}),i.jsx("span",{children:I==="zh"?"é€€å‡ºæŒ‡é’ˆé”å®šæ¨¡å¼":"Exit pointer lock mode"})]})]})]}),i.jsx("div",{className:`absolute inset-0 flex items-center justify-center cursor-pointer z-10 transition-all duration-1000 ${!t&&o&&h&&!Y?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,onClick:()=>{var k;if(!t&&o&&h&&!Y)if((k=K.current)!=null&&k.lock)try{K.current.lock(),setTimeout(()=>{Y||(console.log("Fallback: manually setting pointer locked state"),ae(!0))},100)}catch(ne){console.log("Pointer lock failed, using fallback:",ne.message),ae(!0)}else ae(!0)},children:i.jsxs("div",{className:"bg-white/10 backdrop-blur-md rounded-2xl p-8 text-center transition-all duration-300 border border-white/20 hover:bg-white/20 hover:scale-105",children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-4",children:((Be=($e=(Ge=ge[I])==null?void 0:Ge.gallery)==null?void 0:$e.gallery3D)==null?void 0:Be.title)||"æµ®ç”Ÿé•¿å»Š"}),i.jsx("p",{className:"text-white/80 mb-6",children:((Ue=(qe=(_e=(Oe=ge[I])==null?void 0:Oe.gallery)==null?void 0:_e.gallery3D)==null?void 0:qe.instructions)==null?void 0:Ue.clickToStart)||"ç‚¹å‡»è¿›å…¥"}),i.jsx("div",{className:"animate-bounce",children:i.jsxs("svg",{className:"w-8 h-8 text-white mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})}),Y&&i.jsx(i.Fragment,{children:i.jsxs("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-20",children:[i.jsx("div",{className:"w-2 h-2 bg-white rounded-full shadow-lg border border-white/30"}),i.jsx("div",{className:"absolute w-6 h-0.5 bg-white/60 rounded shadow-sm"}),i.jsx("div",{className:"absolute w-0.5 h-6 bg-white/60 rounded shadow-sm"}),i.jsx("div",{className:"absolute w-8 h-8 border border-white/20 rounded-full"})]})})]})]})};zt.propTypes={language:et.string};export{zt as default};
