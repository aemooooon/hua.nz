<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lorenz Color Test</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #000811;
            overflow: hidden;
            font-family: Arial, sans-serif;
        }
        canvas {
            display: block;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            color: #ffffff;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border-radius: 5px;
            font-size: 14px;
            z-index: 100;
        }
        .color-sample {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin: 2px;
            border: 1px solid #333;
        }
    </style>
</head>
<body>
    <div id="info">
        <h3>Lorenz Attractor Color Test</h3>
        <p>Testing improved bright colors for visibility</p>
        <div>Trail Colors:</div>
        <div class="color-sample" style="background: rgb(255, 102, 25);"></div>
        <div class="color-sample" style="background: rgb(255, 178, 51);"></div>
        <div class="color-sample" style="background: rgb(255, 230, 153);"></div>
        <p>Background: <span style="color: #000811; background: #fff; padding: 2px;">#000811</span></p>
    </div>
    
    <canvas id="testCanvas"></canvas>

    <script type="module">
        import * as THREE from '/node_modules/three/build/three.module.js';
        
        class ColorTest {
            constructor(canvas) {
                this.canvas = canvas;
                this.scene = new THREE.Scene();
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                this.renderer = new THREE.WebGLRenderer({ canvas: this.canvas, antialias: true });
                
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.setClearColor(0x000811, 1.0);
                
                this.camera.position.set(0, 0, 60);
                this.camera.lookAt(0, 0, 0);
                
                // 主球 - 明亮的橙色
                const geometry = new THREE.SphereGeometry(1.5, 16, 16);
                const material = new THREE.MeshBasicMaterial({ 
                    color: 0xff6600,
                    emissive: 0x331100,
                    emissiveIntensity: 0.3
                });
                this.fireball = new THREE.Mesh(geometry, material);
                this.scene.add(this.fireball);
                
                // 测试粒子
                const testParticles = [
                    { pos: [-15, 0, 0], color: new THREE.Color(1.0, 0.4, 0.1) }, // 起始色
                    { pos: [0, 0, 0], color: new THREE.Color(1.0, 0.7, 0.2) },   // 中段色
                    { pos: [15, 0, 0], color: new THREE.Color(1.0, 0.9, 0.6) },  // 末端色
                ];
                
                const particleGeometry = new THREE.SphereGeometry(0.8, 12, 12);
                
                testParticles.forEach((particle, index) => {
                    const material = new THREE.MeshBasicMaterial({
                        color: particle.color,
                        transparent: true,
                        opacity: 0.9,
                        emissive: particle.color.clone().multiplyScalar(0.2),
                        emissiveIntensity: 0.3
                    });
                    
                    const mesh = new THREE.Mesh(particleGeometry, material);
                    mesh.position.set(...particle.pos);
                    this.scene.add(mesh);
                });
                
                // 创建一条测试轨迹
                this.createTestTrail();
                
                // 光照
                const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
                this.scene.add(ambientLight);
                
                this.animate();
            }
            
            createTestTrail() {
                const trailGeometry = new THREE.SphereGeometry(0.4, 8, 8);
                const positions = [];
                
                // 创建一个螺旋轨迹作为测试
                for (let i = 0; i < 100; i++) {
                    const t = i / 100;
                    const x = Math.cos(t * Math.PI * 4) * 20;
                    const y = Math.sin(t * Math.PI * 4) * 20;
                    const z = (t - 0.5) * 30;
                    
                    let color;
                    if (t < 0.3) {
                        color = new THREE.Color(1.0, 0.4, 0.1); // 起始：明亮橙红
                    } else if (t < 0.6) {
                        color = new THREE.Color(1.0, 0.7, 0.2); // 中段：亮橙黄
                    } else {
                        color = new THREE.Color(1.0, 0.9, 0.6); // 末端：亮黄白
                    }
                    
                    const material = new THREE.MeshBasicMaterial({
                        color: color,
                        transparent: true,
                        opacity: 0.9,
                        emissive: color.clone().multiplyScalar(0.2),
                        emissiveIntensity: 0.3
                    });
                    
                    const particle = new THREE.Mesh(trailGeometry, material);
                    particle.position.set(x, y, z);
                    
                    const scale = t * 0.8 + 0.4; // 0.4 到 1.2
                    particle.scale.setScalar(scale);
                    
                    this.scene.add(particle);
                }
            }
            
            animate() {
                requestAnimationFrame(() => this.animate());
                
                // 缓慢旋转以展示效果
                this.scene.rotation.y += 0.005;
                this.scene.rotation.x += 0.002;
                
                this.renderer.render(this.scene, this.camera);
            }
        }
        
        // 启动测试
        const canvas = document.getElementById('testCanvas');
        new ColorTest(canvas);
        
        // 处理窗口大小变化
        window.addEventListener('resize', () => {
            location.reload(); // 简单重载
        });
    </script>
</body>
</html>
